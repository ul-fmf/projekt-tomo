{% extends 'base.html' %}
{% load i18n %}
{% load static %}

{% block content %}
<div class="content-section-a tomo-top-section">
  <div class="container">
    <div class="row">
      {% for course in user_courses %}
        <div class="col-md-6">
          <div class="tomo-course-header">

            <span class="pull-left">
            {% if course.is_taught %}
              <button class="tomo-taught"
                      aria-label="{% trans "Taught course" %}"
                      data-toggle="tooltip"
                      title="{% trans "Taught course" %}">
                <i class="fa fa-graduation-cap fa-lg"></i>
              </button>
            {% else %}
              <button class="tomo-taught">
              <i class="fa fa-star fa-lg"></i>
              </button>
            {% endif %}
            </span>
          
            <h2 class="section-heading">
              <hr class="section-heading-spacer">
              <div class="clearfix"></div>
              <a href="{% url 'course_detail' course.pk %}">
                {{ course.title }}
              </a>
            </h2>
          
          </div>
          <ul class="list-group tomo-courses">
          {% for problem_set in course.annotated_problem_sets %}
          {% include 'courses/_problem_set.html' %}
          {% endfor %}
          </ul>
        </div>
        {% cycle '' '</div><div class="row">' %}
      {% empty %}
      <h3>Nimate predmetov</h3>
      <p>Na spodnjem seznamu poiščite želene predmete in jih
         dodajte med svoje s tem, da pritisnete na zvezdico ob imenu.</p>
      {% endfor %}
    </div>
  </div>
</div>


<div class="tomo-other">
  <div class="container tomo-other">
    <h2>Vsi predmeti</h2>
    {% regroup all_courses by institution.name as institution_list %}
    {% for institution in institution_list %}
    <a class="hide-courses" data-toggle="collapse" href="#inst-{{ forloop.counter}}" aria-expanded="false" aria-controls="inst-{{ forloop.counter}}">{{ institution.grouper }}</a>
    <div class="row collapse" id="inst-{{ forloop.counter}}">
      {% for course in institution.list %}
      <div class="col-md-4">
        <span class="pull-right">
          {% if course.is_favourite %}
          <form action="{% url 'unenroll_from_course' course.pk %}"
                method="post" id='unenroll_from_course_form'>
            {% csrf_token %}
            <button class="tomo-unenroll" type="submit">
              <i class="fa fa-star fa-lg"></i>
              <i class="fa fa-star-o fa-lg"></i>
            </button>
          </form>
          {% else %}
          <form action="{% url 'enroll_in_course' course.pk %}"
                method="post" id='enroll_in_course_form'>
            {% csrf_token %}
            <button class="tomo-enroll" type="submit">
              <i class="fa fa-star fa-lg"></i>
              <i class="fa fa-star-o fa-lg"></i>
            </button>
          </form>
          {% endif %}
        </span>
        <h3>
          <a href="{% url 'course_detail' course.pk %}">{{ course.title }}</a>
        </h3>
        <p class="tomo-lecturer">
          {% for lecturer in course.teachers.all %}
          {{ lecturer.get_full_name }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </p>
      </div>
      {% endfor %}
    </div>
    {% empty %}
      <p style="margin-left:30px;">Ni ostalih ustanov.</p>
    {% endfor %}
  </div>
</div>
{% endblock content %}
