{% extends 'base.html' %}
{% load i18n %}	              
{% load staticfiles %}

{% block title %}Tomo – {{ problem_set.title }}{% endblock %}

 
{% block navigation-left %} 
    <li><a href="{% url 'course_detail' problem_set.course.pk %}">{{ problem_set.course.title }}</a></li>
    <li class="active"><a href="{% url 'problem_set_detail' problem_set.pk %}">{{ problem_set.title }} <span class="sr-only">(current)</span></a></li>
{% endblock %}


{% block content %}
{# display of all problems in a problem set #}
<div class="panel-body">
	<h3>
	  {{ problem_set.title}}
	</h3>
	
	{% if problem_set.description and problem_set.description.strip %}
	          {{ problem_set.description|latex_markdown }}
	{% endif %}
	<div class="btn-toolbar" role="toolbar" aria-label="Buttons">
	        {% if show_teacher_forms %}
            <div class="btn-group" role="group" aria-label="Download">
              <button type="button" class="btn btn-default btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                Prenesi datoteke <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li><a href="{% url 'problem_set_attempts' problem_set.pk %}">Datoteke za reševanje</a></li>
                <li><a href="{% url 'problem_set_edit' problem_set.pk %}">Datoteke za urejanje</a></li>
              </ul>
            </div>
	        <button class="btn btn-default btn-for-modal" aria-label="Create" data-url="{% url 'problem_create' problem_set.id %}">
	            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
	                 {# Translators: Button for creating new problem. #}
					 {% trans "Add new problem" %}
	        </button>
	        {% else %}
		    <div class="btn-group" role="group" aria-label="Download">
	        <a class="btn btn-primary btn-large" href="{% url 'problem_set_attempts' problem_set.pk %}" role="button">
        	{# Translators: Button for downloading all problem files within a problem set. #}
            {% trans "Download all problem files" %}
 	        </a>
		    </div>
	        {% endif %}
	</div>
</div>
{% for problem in problem_set.problems.all %}      
	{% if problem.id in valid_problems_ids %}
		<div id="{{ problem.anchor }}" class="panel panel-success">
	{% elif problem.id in invalid_problems_ids %}
		<div id="{{ problem.anchor }}" class="panel panel-danger">
	{% elif problem.id in half_valid_problems_ids %}
		<div id="{{ problem.anchor }}" class="panel panel-warning">
	{% else %}
		<div id="{{ problem.anchor }}" class="panel panel-default">
	{% endif %}
		<div id="{{ problem.anchor }}" class="panel-heading">
			<div class="row">
			  <div class="col-md-4">
					<h4>
						{{ problem.title }}
					</h4>
					<br>
					{% if show_teacher_forms %}
						{% for tag in problem.tags.all %}
							<button type="button" class="btn btn-default btn-sm tag-button" id="tag_button_"> 
								{{ tag }} 
								<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
							</button>
						{% endfor %}
						<button type="button" class="btn btn-default btn-sm">
							{# Translators: Button for adding new tags #}
							{% trans "Add tag" %}
						</button>
					{% else %}
						{% for tag in problem.tags.all %}
							<button type="button" class="btn btn-default btn-sm disabled"> {{ tag }} </button>
						{% endfor %}
					{% endif %}
			  </div>
			  <div class="col-md-8">
			  <span class="pull-right">
					<div class="btn-toolbar" role="toolbar" aria-label="Buttons">
	                    {% if show_teacher_forms %}
	                    <div class="btn-group" role="group" aria-label="Download">
	                      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
	                        {# Translators: Prenesi datoteko #}
							{% trans "Download file" %}
	                        <span class="caret"></span>
	                      </button>
	                      <ul class="dropdown-menu" role="menu">
	                        <li><a href="{% url 'problem_attempt_file' problem.id %}">
		                        {# Translators: Datoteka za reševanje #}
								{% trans "File for solving" %}
	                        </a></li>
	                        <li><a href="{% url 'problem_edit_file' problem.id %}">
	                        	{# Translators: Datoteka za urejanje #}
								{% trans "File for editing" %}
                        	</a></li>
	                      </ul>
	                    </div>
	                    {% else %}
						<div class="btn-group" role="group" aria-label="Download">
							<a class="btn btn-default" href="{% url 'problem_attempt_file' problem.id %}" role="button">
								{# Translators: Button for downloading a single problem file. #}
								{% trans "Download this problem file" %}
							</a>
						</div>
	                    {% endif %}
	                    <div class="btn-group" role="group" aria-label="Solutions">
			    				<a class="btn btn-default" href="{% url 'problem_solution' problem.id %}" role="button">
			    				    {# Translators: Link to page with solutions. #}
									{% trans "Solutions" %}
			    				</a>
		                </div>						
	                    {% if show_teacher_forms %}
	                    <div class="btn-group" role="group" aria-label="Move">
	                        <a class="btn btn-default" href="{% url 'problem_move' problem.id -1 %}" role="button" aria-label="Move Up">
	                            <span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>
	                        </a>
	                        <a class="btn btn-default" href="{% url 'problem_move' problem.id 1 %}" role="button" aria-label="Move Down">
	                            <span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span>
	                        </a>
	                        <button class="btn btn-default btn-for-modal" aria-label="Update" data-url="{% url 'problem_update' problem.id %}">
	                            <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
	                            {# Translators: Update problem text button. #}
								{% trans "Update" %}
	                        </button>
	                        <button class="btn btn-default btn-for-modal" aria-label="Copy" data-url="{% url 'problem_copy' problem.id %}">
	                        <span class="glyphicon glyphicon-duplicate" aria-hidden="true"></span>
	                        {# Translators: Copy problem text button. #}
							{% trans "Copy" %}								
	                        </button>		                    
	                        <button class="btn btn-default btn-for-modal" aria-label="Delete" data-url="{% url 'problem_delete' problem.id %}">
	                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
	                            {# Translators: Delete problem text button. #}
								{% trans "Delete" %}
	                        </button>
	                    </div>
	                    {% endif %}
  				  </div> 
  				  </span>    
  				</div>
			</div>
			
			
		</div>
  		{% if problem.description and problem.description.strip %}
		<div class="panel-body">
  	    	<p>	
  	       		{{ problem.description|latex_markdown }}
  	    	</p>
 		</div>
  	    {% endif %}
	  	<ul class="list-group">
			{% for part in problem.parts.all %}
	    	<li class="list-group-item">
	      		<p>
	      		    {# Translators: problem set detail #}
	      			{{ forloop.counter }}. {% trans "part" %}    				  
    				{% if part.id in valid_parts_ids %}
    				  <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true" style="color: #468847"></span>
    				{% elif  part.id in invalid_parts_ids %}
    				  <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true" style="color: #A31919"></span>
    				{% endif %}
	      		</p> 
	      		{{ part.description|latex_markdown }}
	    	</li>
			{% endfor %}
   	  	</ul>
   	 </div>
{% endfor %}
{% endblock %} {# content #}

{% block extra_js %}
<!-- for Tree view and modals-->
<script src="{% static "js/bootstrap-treeview.js" %}"></script>
<script src="{% static "js/js_functions.js" %}"></script>
{% endblock %}